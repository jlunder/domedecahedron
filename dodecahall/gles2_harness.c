//========================================================================
// Simple GLFW example
// Copyright (c) Camilla Berglund <elmindreda@elmindreda.org>
//
// This software is provided 'as-is', without any express or implied
// warranty. In no event will the authors be held liable for any damages
// arising from the use of this software.
//
// Permission is granted to anyone to use this software for any purpose,
// including commercial applications, and to alter it and redistribute it
// freely, subject to the following restrictions:
//
// 1. The origin of this software must not be misrepresented; you must not
//    claim that you wrote the original software. If you use this software
//    in a product, an acknowledgment in the product documentation would
//    be appreciated but is not required.
//
// 2. Altered source versions must be plainly marked as such, and must not
//    be misrepresented as being the original software.
//
// 3. This notice may not be removed or altered from any source
//    distribution.
//
//========================================================================

#include "gles2_harness.h"

#include <GLFW/glfw3.h>

#include <math.h>
#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include <stdbool.h>
#include <string.h>


bool gles2_harness_init(void);
void gles2_harness_reshape(int width, int height);
void gles2_harness_update(float time);
void gles2_harness_terminate(void);


static GLuint g_program;
static GLuint g_vertShader;
static GLuint g_fragShader;

static GLint g_viewProjectionMatrixLocation;
static GLint g_modelMatrixLocation;
static GLint g_colorLocation;

static GLint g_vertexLocation;

static GLuint g_verticesVBO;

static GLfloat g_aspectRatio;

int32_t gles2_harness_light_index = 0;
int64_t gles2_harness_total_nsec = 0;



static void error_callback(int error, const char* description)
{
    (void)error;
    
    fputs(description, stderr);
}

static void key_callback(GLFWwindow* window, int key, int scancode, int action, int mods)
{
    (void)scancode;
    (void)mods;
    
    if (key == GLFW_KEY_ESCAPE && action == GLFW_PRESS)
        glfwSetWindowShouldClose(window, GL_TRUE);
}

void gles2_harness_main(void)
{
    GLFWwindow* window;

    glfwSetErrorCallback(error_callback);

    if (!glfwInit())
        exit(EXIT_FAILURE);

    window = glfwCreateWindow(640, 480, "Dodecahall", NULL, NULL);
    if (!window)
    {
        glfwTerminate();
        exit(EXIT_FAILURE);
    }

    glfwMakeContextCurrent(window);

    glfwSetKeyCallback(window, key_callback);
    
    gles2_harness_init();

    while (!glfwWindowShouldClose(window))
    {
        float ratio;
        int width, height;

        glfwGetFramebufferSize(window, &width, &height);
        ratio = width / (float) height;

/*
        glViewport(0, 0, width, height);
        glClear(GL_COLOR_BUFFER_BIT);

        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        glOrtho(-ratio, ratio, -1.f, 1.f, 1.f, -1.f);
        glMatrixMode(GL_MODELVIEW);

        glLoadIdentity();
        glRotatef((float) glfwGetTime() * 50.f, 0.f, 0.f, 1.f);

        glBegin(GL_TRIANGLES);
        glColor3f(1.f, 0.f, 0.f);
        glVertex3f(-0.6f, -0.4f, 0.f);
        glColor3f(0.f, 1.f, 0.f);
        glVertex3f(0.6f, -0.4f, 0.f);
        glColor3f(0.f, 0.f, 1.f);
        glVertex3f(0.f, 0.6f, 0.f);
        glEnd();
        */
        
        gles2_harness_reshape(width, height);
        gles2_harness_update(0.0f);

        glfwSwapBuffers(window);
        glfwPollEvents();
    }
    
    gles2_harness_terminate();

    glfwDestroyWindow(window);

    glfwTerminate();
    exit(EXIT_SUCCESS);
}


static char const * light_frag =
    //"precision lowp float;\n"
    "\n"
    "uniform vec4 u_color;\n"
    "\n"
    "varying vec2 v_texCoord;\n"
    "\n"
    "void main(void)\n"
    "{\n"
    "	gl_FragColor = u_color * max(0.0, 1.0 - length(v_texCoord));\n"
    "}\n";

static char const * light_vert =
    "uniform mat4 u_viewProjectionMatrix;\n"
    "uniform mat4 u_modelMatrix;\n"
    "\n"
    "attribute vec4 a_vertex;\n"
    "\n"
    "varying vec4 v_color;\n"
    "varying vec2 v_texCoord;\n"
    "\n"
    "void main(void)\n"
    "{\n"
    "	gl_Position = u_viewProjectionMatrix * u_modelMatrix * a_vertex;\n"
    "	//gl_Position = vec4(a_texCoord.x, a_texCoord.y, 0.0, 0.0);\n"
    "	v_texCoord = a_vertex.xy;\n"
    "}\n";


static void show_info_log(
    GLuint object,
    void (* glGet__iv)(GLuint, GLenum, GLsizei *),
    void (* glGet__InfoLog)(GLuint, GLsizei, GLsizei *, GLchar *)
)
{
    GLint log_length;
    char *log;

    glGet__iv(object, GL_INFO_LOG_LENGTH, &log_length);
    log = malloc(log_length);
    glGet__InfoLog(object, log_length, NULL, log);
    fprintf(stderr, "%s", log);
    free(log);
}

bool gles2_harness_init(void)
{
    GLchar const * vert_source = light_vert;
    GLint vert_length = strlen(light_vert);
    GLchar const * frag_source = light_frag;
    GLint frag_length = strlen(light_frag);
    GLint result;
    
    g_vertShader = glCreateShader(GL_VERTEX_SHADER);
    glShaderSource(g_vertShader, 1, &vert_source, &vert_length);
    glCompileShader(g_vertShader);
    glGetShaderiv(g_vertShader, GL_COMPILE_STATUS, &result);
    if (!result) {
        fprintf(stderr, "Failed to compile vertex shader\n");
        show_info_log(g_vertShader, glGetShaderiv, glGetShaderInfoLog);
        glDeleteShader(g_vertShader);
        exit(2);
    }
    
    g_fragShader = glCreateShader(GL_FRAGMENT_SHADER);
    glShaderSource(g_fragShader, 1, &frag_source, &frag_length);
    glCompileShader(g_fragShader);
    glGetShaderiv(g_fragShader, GL_COMPILE_STATUS, &result);
    if (!result) {
        fprintf(stderr, "Failed to compile fragment shader\n");
        show_info_log(g_fragShader, glGetShaderiv, glGetShaderInfoLog);
        glDeleteShader(g_fragShader);
        exit(2);
    }
    
    g_program = glCreateProgram();
    glAttachShader(g_program, g_vertShader);
    glAttachShader(g_program, g_fragShader);
    glLinkProgram(g_program);
    glGetProgramiv(g_program, GL_LINK_STATUS, &result);
    if (!result) {
        fprintf(stderr, "Failed to compile link shader program\n");
        show_info_log(g_program, glGetProgramiv, glGetProgramInfoLog);
        glDeleteProgram(g_program);
        exit(2);
    }
    
    g_viewProjectionMatrixLocation = glGetUniformLocation(g_program, "u_viewProjectionMatrix");
    g_modelMatrixLocation = glGetUniformLocation(g_program, "u_modelMatrix");
    g_colorLocation = glGetUniformLocation(g_program, "u_color");
    
    g_vertexLocation = glGetAttribLocation(g_program, "a_vertex");
    
    //glEnable(GL_DEPTH_TEST);
    
    // premultiplied alpha
    glEnable(GL_BLEND);
    glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_ALPHA);
    
    glClearColor(0.0f, 0.0f, 0.0f, 1.0f);
    //glClearDepthf(1.0f);
    
    GLfloat lightVertices[] = {
        -1.0f,  1.0f, 0.0f, 1.0f,
         1.0f,  1.0f, 0.0f, 1.0f,
        -1.0f, -1.0f, 0.0f, 1.0f,
         1.0f, -1.0f, 0.0f, 1.0f,
    };
    
    glGenBuffers(1, &g_verticesVBO);
    glBindBuffer(GL_ARRAY_BUFFER, g_verticesVBO);
    glBufferData(GL_ARRAY_BUFFER, 4 * 4 * sizeof (GLfloat), (GLfloat*)lightVertices, GL_STATIC_DRAW);
    
    glBindBuffer(GL_ARRAY_BUFFER, 0);
    
    //artifactuary_init();
    
    return true;
}


void gles2_harness_reshape(int width, int height)
{
    // Set the viewport depending on the width and height of the window.
    glViewport(0, 0, width, height);
    
    g_aspectRatio = (GLfloat)width / (GLfloat)height;
}

GLfloat glusVector3Lengthf(const GLfloat vector[3])
{
    return sqrtf(vector[0] * vector[0] + vector[1] * vector[1] + vector[2] * vector[2]);
}

bool glusVector3Normalizef(GLfloat vector[3])
{
    GLint i;

    GLfloat length = glusVector3Lengthf(vector);

    if (length == 0.0f)
    {
        return false;
    }

    for (i = 0; i < 3; i++)
    {
        vector[i] /= length;
    }

    return true;
}

void glusVector3Crossf(GLfloat result[3], const GLfloat vector0[3], const GLfloat vector1[3])
{
    GLint i;

    GLfloat temp[3];

    temp[0] = vector0[1] * vector1[2] - vector0[2] * vector1[1];
    temp[1] = vector0[2] * vector1[0] - vector0[0] * vector1[2];
    temp[2] = vector0[0] * vector1[1] - vector0[1] * vector1[0];

    for (i = 0; i < 3; i++)
    {
        result[i] = temp[i];
    }
}

void glusMatrix4x4Multiplyf(GLfloat matrix[16], const GLfloat matrix0[16], const GLfloat matrix1[16])
{
    GLint i;
    GLint k;

    GLfloat temp[16];

    GLint row;
    GLint column;
    for (i = 0; i < 16; i++)
    {
        temp[i] = 0.0f;

        row = i % 4;
        column = (i / 4) * 4;

        for (k = 0; k < 4; k++)
        {
            //			  	   row   column   		  row column
            temp[i] += matrix0[row + k * 4] * matrix1[k + column];
        }
    }

    for (i = 0; i < 16; i++)
    {
        matrix[i] = temp[i];
    }
}

void glusMatrix4x4Identityf(GLfloat matrix[16])
{
    matrix[0] = 1.0f;
    matrix[1] = 0.0f;
    matrix[2] = 0.0f;
    matrix[3] = 0.0f;

    matrix[4] = 0.0f;
    matrix[5] = 1.0f;
    matrix[6] = 0.0f;
    matrix[7] = 0.0f;

    matrix[8] = 0.0f;
    matrix[9] = 0.0f;
    matrix[10] = 1.0f;
    matrix[11] = 0.0f;

    matrix[12] = 0.0f;
    matrix[13] = 0.0f;
    matrix[14] = 0.0f;
    matrix[15] = 1.0f;
}

void glusMatrix4x4Scalef(GLfloat matrix[16], const GLfloat x, const GLfloat y, const GLfloat z)
{
    GLfloat temp[16];

    glusMatrix4x4Identityf(temp);

    temp[0] = x;
    temp[5] = y;
    temp[10] = z;

    glusMatrix4x4Multiplyf(matrix, matrix, temp);
}

void glusMatrix4x4Translatef(GLfloat matrix[16], const GLfloat x, const GLfloat y, const GLfloat z)
{
    GLfloat temp[16];

    glusMatrix4x4Identityf(temp);

    temp[12] = x;
    temp[13] = y;
    temp[14] = z;

    glusMatrix4x4Multiplyf(matrix, matrix, temp);
}

void glusLookAtf(GLfloat result[16], const GLfloat eyeX, const GLfloat eyeY, const GLfloat eyeZ, const GLfloat centerX, const GLfloat centerY, const GLfloat centerZ, const GLfloat upX, const GLfloat upY, const GLfloat upZ)
{
    GLfloat forward[3], side[3], up[3];

    forward[0] = centerX - eyeX;
    forward[1] = centerY - eyeY;
    forward[2] = centerZ - eyeZ;

    glusVector3Normalizef(forward);

    up[0] = upX;
    up[1] = upY;
    up[2] = upZ;

    glusVector3Crossf(side, forward, up);
    glusVector3Normalizef(side);

    glusVector3Crossf(up, side, forward);

    result[0] = side[0];
    result[1] = up[0];
    result[2] = -forward[0];
    result[3] = 0.0f;
    result[4] = side[1];
    result[5] = up[1];
    result[6] = -forward[1];
    result[7] = 0.0f;
    result[8] = side[2];
    result[9] = up[2];
    result[10] = -forward[2];
    result[11] = 0.0f;
    result[12] = 0.0f;
    result[13] = 0.0f;
    result[14] = 0.0f;
    result[15] = 1.0f;

    glusMatrix4x4Translatef(result, -eyeX, -eyeY, -eyeZ);
}

bool glusFrustumf(GLfloat result[16], const GLfloat left, const GLfloat right, const GLfloat bottom, const GLfloat top, const GLfloat nearVal, const GLfloat farVal)
{
	if ((right - left) == 0.0f || (top - bottom) == 0.0f || (farVal - nearVal) == 0.0f)
	{
		return false;
	}

	result[0] = 2.0f * nearVal / (right - left);
    result[1] = 0.0f;
    result[2] = 0.0f;
    result[3] = 0.0f;
    result[4] = 0.0f;
    result[5] = 2.0f * nearVal / (top - bottom);
    result[6] = 0.0f;
    result[7] = 0.0f;
    result[8] = (right + left) / (right - left);
    result[9] = (top + bottom) / (top - bottom);
    result[10] = -(farVal + nearVal) / (farVal - nearVal);
    result[11] = -1.0f;
    result[12] = 0.0f;
    result[13] = 0.0f;
    result[14] = -(2.0f * farVal * nearVal) / (farVal - nearVal);
    result[15] = 0.0f;

    return true;
}

bool glusPerspectivef(GLfloat result[16], const GLfloat fovy, const GLfloat aspect, const GLfloat zNear, const GLfloat zFar)
{
    GLfloat xmin, xmax, ymin, ymax;

    ymax = zNear * tanf(fovy * ((float)M_PI / 360.0f));
    ymin = -ymax;
    xmin = ymin * aspect;
    xmax = ymax * aspect;

    return glusFrustumf(result, xmin, xmax, ymin, ymax, zNear, zFar);
}



typedef struct {
    float x, y, z;
} vertex_t;

typedef uint16_t index_t;

typedef struct {
    index_t * index_start;
    size_t num_indices;
} shape_t;

typedef struct {
    shape_t * shape_start;
    size_t num_shapes;
} group_t;

vertex_t vertices[573] = {
    {-1.37638, 0.0, 0.262866,},
    {1.37638, 0.0, -0.262866,},
    {-0.425325, -1.30902, 0.262866,},
    {-0.425325, 1.30902, 0.262866,},
    {1.11352, -0.809017, 0.262866,},
    {1.11352, 0.809017, 0.262866,},
    {-0.262866, -0.809017, 1.11352,},
    {-0.262866, 0.809017, 1.11352,},
    {-0.688191, -0.5, -1.11352,},
    {-0.688191, 0.5, -1.11352,},
    {0.688191, -0.5, 1.11352,},
    {0.688191, 0.5, 1.11352,},
    {0.850651, 0.0, -1.11352,},
    {-1.11352, -0.809017, -0.262866,},
    {-1.11352, 0.809017, -0.262866,},
    {-0.850651, 0.0, 1.11352,},
    {0.262866, -0.809017, -1.11352,},
    {0.262866, 0.809017, -1.11352,},
    {0.425325, -1.30902, -0.262866,},
    {0.425325, 1.30902, -0.262866,},
    {-2.60746, 0.0, -2.25478,},
    {-1.94702, -1.30902, -0.49798,},
    {-1.94702, 1.30902, -0.49798,},
    {-2.87032, -0.809017, -1.72905,},
    {-2.87032, 0.809017, -1.72905,},
    {-2.72501, -0.809017, -0.117557,},
    {-2.72501, 0.809017, -0.117557,},
    {-3.29565, -0.5, -0.878402,},
    {-3.29565, 0.5, -0.878402,},
    {-1.6115, 0.0, -2.34459,},
    {-2.37234, 0.0, 0.352671,},
    {-1.25882, -0.809017, -1.87436,},
    {-1.25882, 0.809017, -1.87436,},
    {-2.03682, -1.30902, -1.49394,},
    {-2.03682, 1.30902, -1.49394,},
    {-1.84661, 1.44721, -0.49798,},
    {0.615537, 2.34164, -1.49394,},
    {-1.6564, 2.47984, -1.72905,},
    {-0.117557, 2.97984, -1.72905,},
    {0.643288, 2.25623, -0.49798,},
    {-1.49394, 2.97984, -0.878402,},
    {-0.733094, 2.25623, 0.352671,},
    {-1.15842, 0.947214, -1.87436,},
    {-0.542882, 3.28885, -0.878402,},
    {-0.0726543, 2.84164, -0.117557,},
    {0.380423, 1.44721, -1.87436,},
    {-1.87436, 1.53262, -1.49394,},
    {-1.6115, 2.34164, -0.117557,},
    {-0.49798, 1.53262, -2.34459,},
    {-0.805748, 2.47984, -2.25478,},
    {1.84661, 2.34164, -1.72905,},
    {2.79767, 1.03262, -1.72905,},
    {0.805748, 2.20344, -0.49798,},
    {2.34459, 0.0854102, -0.49798,},
    {2.96013, 1.53262, -0.878402,},
    {1.72905, 2.25623, -0.117557,},
    {1.30373, 0.947214, -2.34459,},
    {0.542882, 1.39443, -1.87436,},
    {2.68011, 0.947214, -0.117557,},
    {1.91926, 1.39443, 0.352671,},
    {2.10948, 1.53262, -2.25478,},
    {0.878402, 2.25623, -1.49394,},
    {2.37234, 2.34164, -0.878402,},
    {1.49394, 0.0854102, -1.87436,},
    {2.41724, 0.138197, -1.49394,},
    {1.84661, -2.34164, -1.72905,},
    {0.805748, -2.20344, -0.49798,},
    {2.79767, -1.03262, -1.72905,},
    {2.34459, -0.0854102, -0.49798,},
    {1.72905, -2.25623, -0.117557,},
    {2.96013, -1.53262, -0.878402,},
    {0.542882, -1.39443, -1.87436,},
    {1.30373, -0.947214, -2.34459,},
    {1.91926, -1.39443, 0.352671,},
    {2.68011, -0.947214, -0.117557,},
    {0.878402, -2.25623, -1.49394,},
    {2.10948, -1.53262, -2.25478,},
    {2.37234, -2.34164, -0.878402,},
    {1.49394, -0.0854102, -1.87436,},
    {2.41724, -0.138197, -1.49394,},
    {-1.84661, -1.44721, -0.49798,},
    {0.615537, -2.34164, -1.49394,},
    {-1.6564, -2.47984, -1.72905,},
    {0.643288, -2.25623, -0.49798,},
    {-0.117557, -2.97984, -1.72905,},
    {-0.733094, -2.25623, 0.352671,},
    {-1.49394, -2.97984, -0.878402,},
    {-1.15842, -0.947214, -1.87436,},
    {-0.0726543, -2.84164, -0.117557,},
    {-0.542882, -3.28885, -0.878402,},
    {0.380423, -1.44721, -1.87436,},
    {-1.87436, -1.53262, -1.49394,},
    {-1.6115, -2.34164, -0.117557,},
    {-0.49798, -1.53262, -2.34459,},
    {-0.805748, -2.47984, -2.25478,},
    {-5.83045, -1.44721, -2.4899,},
    {-3.3683, -2.34164, -3.48586,},
    {-4.40916, -1.30902, -1.72905,},
    {-5.64024, -2.47984, -3.72097,},
    {-3.34055, -2.25623, -2.4899,},
    {-4.10139, -2.97984, -3.72097,},
    {-4.71693, -2.25623, -1.63925,},
    {-5.47778, -2.97984, -2.87032,},
    {-4.67203, -0.5, -3.10543,},
    {-5.14226, -0.947214, -3.86628,},
    {-4.05649, -2.84164, -2.10948,},
    {-4.52672, -3.28885, -2.87032,},
    {-3.60341, -1.44721, -3.86628,},
    {-5.09735, -0.809017, -2.25478,},
    {-5.8582, -1.53262, -3.48586,},
    {-5.59533, -2.34164, -2.10948,},
    {-3.72097, -0.809017, -3.10543,},
    {-4.48182, -1.53262, -4.33651,},
    {-3.55851, -1.30902, -2.25478,},
    {-4.78959, -2.47984, -4.2467,},
    {-2.60746, 3.78885, -1.72905,},
    {-3.83853, 3.78885, -4.2467,},
    {-3.17809, 2.47984, -2.4899,},
    {-3.17809, 5.09787, -2.4899,},
    {-4.10139, 2.97984, -3.72097,},
    {-4.10139, 4.59787, -3.72097,},
    {-3.95609, 2.97984, -2.10948,},
    {-3.95609, 4.59787, -2.10948,},
    {-1.91926, 3.28885, -3.10543,},
    {-1.91926, 4.28885, -3.10543,},
    {-4.52672, 3.28885, -2.87032,},
    {-4.52672, 4.28885, -2.87032,},
    {-2.84257, 3.78885, -4.33651,},
    {-2.34459, 2.97984, -2.25478,},
    {-2.34459, 4.59787, -2.25478,},
    {-3.60341, 3.78885, -1.63925,},
    {-2.4899, 2.97984, -3.86628,},
    {-2.4899, 4.59787, -3.86628,},
    {-3.26789, 2.47984, -3.48586,},
    {-3.26789, 5.09787, -3.48586,},
    {1.37638, 3.78885, -2.4899,},
    {3.83853, 4.68328, -3.48586,},
    {1.56659, 4.82148, -3.72097,},
    {2.79767, 3.65066, -1.72905,},
    {3.10543, 5.32148, -3.72097,},
    {3.86628, 4.59787, -2.4899,},
    {1.72905, 5.32148, -2.87032,},
    {2.4899, 4.59787, -1.63925,},
    {2.06457, 3.28885, -3.86628,},
    {2.5348, 2.84164, -3.10543,},
    {2.68011, 5.6305, -2.87032,},
    {3.15034, 5.18328, -2.10948,},
    {3.60341, 3.78885, -3.86628,},
    {1.34863, 3.87426, -3.48586,},
    {2.10948, 3.15066, -2.25478,},
    {1.6115, 4.68328, -2.10948,},
    {2.72501, 3.87426, -4.33651,},
    {3.48586, 3.15066, -3.10543,},
    {2.41724, 4.82148, -4.2467,},
    {3.64832, 3.65066, -2.25478,},
    {5.0696, 0.0, -3.72097,},
    {4.59937, -2.34164, -2.25478,},
    {6.02066, -1.30902, -3.72097,},
    {4.02874, -0.138197, -2.4899,},
    {5.56758, -2.25623, -2.4899,},
    {4.33651, -1.53262, -1.72905,},
    {6.18312, -0.809017, -2.87032,},
    {4.95205, -0.0854102, -2.10948,},
    {4.52672, -1.39443, -4.33651,},
    {3.76587, -0.947214, -3.86628,},
    {5.9031, -1.39443, -2.10948,},
    {5.14226, -0.947214, -1.63925,},
    {4.07364, -2.34164, -3.10543,},
    {5.33247, -0.809017, -4.2467,},
    {4.10139, -0.0854102, -3.48586,},
    {5.59533, -4.44089e-16, -2.87032,},
    {4.71693, -2.25623, -3.86628,},
    {3.48586, -1.53262, -3.10543,},
    {5.64024, -2.20344, -3.48586,},
    {3.64832, -1.03262, -2.25478,},
    {0.615537, -6.1305, -3.72097,},
    {0.145309, -3.78885, -2.25478,},
    {-0.425325, -5.9923, -2.4899,},
    {1.56659, -4.82148, -3.72097,},
    {-0.117557, -4.59787, -1.72905,},
    {1.11352, -3.87426, -2.4899,},
    {0.49798, -6.04508, -2.10948,},
    {1.72905, -5.32148, -2.87032,},
    {-0.688191, -5.18328, -3.86628,},
    {0.0726543, -4.73607, -4.33651,},
    {0.688191, -5.18328, -1.63925,},
    {1.44904, -4.73607, -2.10948,},
    {-0.380423, -3.78885, -3.10543,},
    {-0.352671, -6.04508, -3.48586,},
    {0.878402, -5.32148, -4.2467,},
    {1.14127, -6.1305, -2.87032,},
    {-0.968208, -4.59787, -3.10543,},
    {0.262866, -3.87426, -3.86628,},
    {-0.805748, -5.09787, -2.25478,},
    {1.18617, -3.92705, -3.48586,},
    {-5.83045, 1.44721, -2.4899,},
    {-3.3683, 2.34164, -3.48586,},
    {-5.64024, 2.47984, -3.72097,},
    {-4.40916, 1.30902, -1.72905,},
    {-3.34055, 2.25623, -2.4899,},
    {-5.47778, 2.97984, -2.87032,},
    {-4.71693, 2.25623, -1.63925,},
    {-5.14226, 0.947214, -3.86628,},
    {-4.67203, 0.5, -3.10543,},
    {-4.05649, 2.84164, -2.10948,},
    {-3.60341, 1.44721, -3.86628,},
    {-5.8582, 1.53262, -3.48586,},
    {-5.09735, 0.809017, -2.25478,},
    {-5.59533, 2.34164, -2.10948,},
    {-4.48182, 1.53262, -4.33651,},
    {-3.72097, 0.809017, -3.10543,},
    {-4.78959, 2.47984, -4.2467,},
    {-3.55851, 1.30902, -2.25478,},
    {0.615537, 6.1305, -3.72097,},
    {0.145309, 3.78885, -2.25478,},
    {-0.425325, 5.9923, -2.4899,},
    {1.11352, 3.87426, -2.4899,},
    {-0.117557, 4.59787, -1.72905,},
    {0.49798, 6.04508, -2.10948,},
    {0.0726543, 4.73607, -4.33651,},
    {-0.688191, 5.18328, -3.86628,},
    {1.44904, 4.73607, -2.10948,},
    {0.688191, 5.18328, -1.63925,},
    {-0.380423, 3.78885, -3.10543,},
    {0.878402, 5.32148, -4.2467,},
    {-0.352671, 6.04508, -3.48586,},
    {1.14127, 6.1305, -2.87032,},
    {0.262866, 3.87426, -3.86628,},
    {-0.968208, 4.59787, -3.10543,},
    {1.18617, 3.92705, -3.48586,},
    {-0.805748, 5.09787, -2.25478,},
    {5.0696, -3.55271e-15, -3.72097,},
    {4.59937, 2.34164, -2.25478,},
    {4.02874, 0.138197, -2.4899,},
    {6.02066, 1.30902, -3.72097,},
    {4.33651, 1.53262, -1.72905,},
    {5.56758, 2.25623, -2.4899,},
    {4.95205, 0.0854102, -2.10948,},
    {6.18312, 0.809017, -2.87032,},
    {3.76587, 0.947214, -3.86628,},
    {4.52672, 1.39443, -4.33651,},
    {5.14226, 0.947214, -1.63925,},
    {5.9031, 1.39443, -2.10948,},
    {4.07364, 2.34164, -3.10543,},
    {4.10139, 0.0854102, -3.48586,},
    {5.33247, 0.809017, -4.2467,},
    {5.59533, -3.55271e-15, -2.87032,},
    {3.48586, 1.53262, -3.10543,},
    {4.71693, 2.25623, -3.86628,},
    {3.64832, 1.03262, -2.25478,},
    {5.64024, 2.20344, -3.48586,},
    {1.37638, -3.78885, -2.4899,},
    {3.83853, -4.68328, -3.48586,},
    {2.79767, -3.65066, -1.72905,},
    {3.86628, -4.59787, -2.4899,},
    {3.10543, -5.32148, -3.72097,},
    {2.4899, -4.59787, -1.63925,},
    {2.5348, -2.84164, -3.10543,},
    {2.06457, -3.28885, -3.86628,},
    {3.15034, -5.18328, -2.10948,},
    {2.68011, -5.6305, -2.87032,},
    {3.60341, -3.78885, -3.86628,},
    {2.10948, -3.15066, -2.25478,},
    {1.34863, -3.87426, -3.48586,},
    {1.6115, -4.68328, -2.10948,},
    {3.48586, -3.15066, -3.10543,},
    {2.72501, -3.87426, -4.33651,},
    {3.64832, -3.65066, -2.25478,},
    {2.41724, -4.82148, -4.2467,},
    {-2.60746, -3.78885, -1.72905,},
    {-3.83853, -3.78885, -4.2467,},
    {-3.17809, -5.09787, -2.4899,},
    {-3.17809, -2.47984, -2.4899,},
    {-4.10139, -4.59787, -3.72097,},
    {-3.95609, -4.59787, -2.10948,},
    {-3.95609, -2.97984, -2.10948,},
    {-1.91926, -4.28885, -3.10543,},
    {-1.91926, -3.28885, -3.10543,},
    {-4.52672, -4.28885, -2.87032,},
    {-2.84257, -3.78885, -4.33651,},
    {-2.34459, -4.59787, -2.25478,},
    {-2.34459, -2.97984, -2.25478,},
    {-3.60341, -3.78885, -1.63925,},
    {-2.4899, -4.59787, -3.86628,},
    {-2.4899, -2.97984, -3.86628,},
    {-3.26789, -5.09787, -3.48586,},
    {-3.26789, -2.47984, -3.48586,},
    {-6.59129, 3.78885, -3.72097,},
    {-5.64024, 5.09787, -3.72097,},
    {-5.47778, 4.59787, -2.87032,},
    {-5.9031, 3.28885, -5.09735,},
    {-5.9031, 4.28885, -5.09735,},
    {-4.36426, 3.78885, -5.09735,},
    {-6.32843, 2.97984, -4.2467,},
    {-6.32843, 4.59787, -4.2467,},
    {-6.06556, 3.78885, -2.87032,},
    {-4.95205, 2.97984, -5.09735,},
    {-4.95205, 4.59787, -5.09735,},
    {-4.78959, 5.09787, -4.2467,},
    {3.3683, 6.1305, -4.2467,},
    {1.56659, 7.43951, -3.72097,},
    {3.10543, 6.93951, -3.72097,},
    {1.72905, 6.93951, -2.87032,},
    {1.30373, 5.6305, -5.09735,},
    {1.30373, 6.6305, -5.09735,},
    {2.68011, 6.6305, -2.87032,},
    {2.84257, 6.1305, -5.09735,},
    {0.878402, 6.93951, -4.2467,},
    {2.25478, 5.32148, -5.09735,},
    {2.25478, 6.93951, -5.09735,},
    {2.41724, 7.43951, -4.2467,},
    {5.0696, -2.66454e-15, -3.72097,},
    {7.82237, -1.15463e-14, -4.2467,},
    {7.5595, -0.809017, -3.72097,},
    {7.5595, 0.809017, -3.72097,},
    {5.75779, -0.5, -5.09735,},
    {5.75779, 0.5, -5.09735,},
    {7.13418, -0.5, -2.87032,},
    {7.13418, 0.5, -2.87032,},
    {7.29663, -9.76996e-15, -5.09735,},
    {6.70885, -0.809017, -5.09735,},
    {6.70885, 0.809017, -5.09735,},
    {6.87131, -1.30902, -4.2467,},
    {6.87131, 1.30902, -4.2467,},
    {3.3683, -6.1305, -4.2467,},
    {1.56659, -7.43951, -3.72097,},
    {3.10543, -6.93951, -3.72097,},
    {1.72905, -6.93951, -2.87032,},
    {1.30373, -6.6305, -5.09735,},
    {1.30373, -5.6305, -5.09735,},
    {2.68011, -6.6305, -2.87032,},
    {2.84257, -6.1305, -5.09735,},
    {0.878402, -6.93951, -4.2467,},
    {2.25478, -6.93951, -5.09735,},
    {2.25478, -5.32148, -5.09735,},
    {2.41724, -7.43951, -4.2467,},
    {-6.59129, -3.78885, -3.72097,},
    {-5.64024, -5.09787, -3.72097,},
    {-5.47778, -4.59787, -2.87032,},
    {-5.9031, -4.28885, -5.09735,},
    {-5.9031, -3.28885, -5.09735,},
    {-4.36426, -3.78885, -5.09735,},
    {-6.32843, -4.59787, -4.2467,},
    {-6.32843, -2.97984, -4.2467,},
    {-6.06556, -3.78885, -2.87032,},
    {-4.95205, -4.59787, -5.09735,},
    {-4.95205, -2.97984, -5.09735,},
    {-4.78959, -5.09787, -4.2467,},
    {-7.06152, 2.34164, -4.48182,},
    {-4.59937, 1.44721, -5.47778,},
    {-6.87131, 1.30902, -5.71289,},
    {-4.57162, 1.53262, -4.48182,},
    {-5.33247, 0.809017, -5.71289,},
    {-5.948, 1.53262, -3.63117,},
    {-6.70885, 0.809017, -4.86224,},
    {-6.37333, 2.84164, -5.8582,},
    {-5.28756, 0.947214, -4.10139,},
    {-5.75779, 0.5, -4.86224,},
    {-4.83449, 2.34164, -5.8582,},
    {-7.08927, 2.25623, -5.47778,},
    {-6.82641, 1.44721, -4.10139,},
    {-5.71289, 2.25623, -6.32843,},
    {-6.02066, 1.30902, -6.23862,},
    {-0.615537, 6.1305, -6.23862,},
    {0.0449028, 4.82148, -4.48182,},
    {0.0449028, 7.43951, -4.48182,},
    {-0.878402, 5.32148, -5.71289,},
    {-0.878402, 6.93951, -5.71289,},
    {-0.733094, 5.32148, -4.10139,},
    {-0.733094, 6.93951, -4.10139,},
    {-1.30373, 5.6305, -4.86224,},
    {-1.30373, 6.6305, -4.86224,},
    {0.380423, 6.1305, -6.32843,},
    {-0.380423, 6.1305, -3.63117,},
    {0.733094, 5.32148, -5.8582,},
    {0.733094, 6.93951, -5.8582,},
    {-0.0449028, 4.82148, -5.47778,},
    {-0.0449028, 7.43951, -5.47778,},
    {4.59937, 1.44721, -4.48182,},
    {7.06152, 2.34164, -5.47778,},
    {4.78959, 2.47984, -5.71289,},
    {6.32843, 2.97984, -5.71289,},
    {7.08927, 2.25623, -4.48182,},
    {4.95205, 2.97984, -4.86224,},
    {5.71289, 2.25623, -3.63117,},
    {5.28756, 0.947214, -5.8582,},
    {5.9031, 3.28885, -4.86224,},
    {6.37333, 2.84164, -4.10139,},
    {6.82641, 1.44721, -5.8582,},
    {4.57162, 1.53262, -5.47778,},
    {4.83449, 2.34164, -4.10139,},
    {5.948, 1.53262, -6.32843,},
    {5.64024, 2.47984, -6.23862,},
    {3.83853, -3.78885, -5.71289,},
    {4.78959, -5.09787, -5.71289,},
    {2.79767, -3.92705, -4.48182,},
    {4.33651, -6.04508, -4.48182,},
    {4.95205, -4.59787, -4.86224,},
    {3.72097, -3.87426, -4.10139,},
    {3.29565, -5.18328, -6.32843,},
    {2.5348, -4.73607, -5.8582,},
    {4.67203, -5.18328, -4.10139,},
    {3.91118, -4.73607, -3.63117,},
    {4.10139, -4.59787, -6.23862,},
    {2.87032, -3.87426, -5.47778,},
    {4.36426, -3.78885, -4.86224,},
    {3.48586, -6.04508, -5.8582,},
    {4.40916, -5.9923, -5.47778,},
    {-3.3683, -6.1305, -5.71289,},
    {-4.40916, -5.9923, -4.48182,},
    {-2.41724, -4.82148, -5.71289,},
    {-2.87032, -3.87426, -4.48182,},
    {-3.48586, -6.04508, -4.10139,},
    {-2.25478, -5.32148, -4.86224,},
    {-4.67203, -5.18328, -5.8582,},
    {-3.91118, -4.73607, -6.32843,},
    {-3.29565, -5.18328, -3.63117,},
    {-2.5348, -4.73607, -4.10139,},
    {-4.33651, -6.04508, -5.47778,},
    {-3.10543, -5.32148, -6.23862,},
    {-2.84257, -6.1305, -4.86224,},
    {-3.72097, -3.87426, -5.8582,},
    {-2.79767, -3.92705, -5.47778,},
    {-3.3683, 6.1305, -5.71289,},
    {-2.41724, 4.82148, -5.71289,},
    {-4.40916, 5.9923, -4.48182,},
    {-2.87032, 3.87426, -4.48182,},
    {-2.25478, 5.32148, -4.86224,},
    {-3.48586, 6.04508, -4.10139,},
    {-3.91118, 4.73607, -6.32843,},
    {-4.67203, 5.18328, -5.8582,},
    {-2.5348, 4.73607, -4.10139,},
    {-3.29565, 5.18328, -3.63117,},
    {-3.10543, 5.32148, -6.23862,},
    {-4.33651, 6.04508, -5.47778,},
    {-2.84257, 6.1305, -4.86224,},
    {-3.72097, 3.87426, -5.8582,},
    {-2.79767, 3.92705, -5.47778,},
    {3.83853, 3.78885, -5.71289,},
    {2.79767, 3.92705, -4.48182,},
    {4.78959, 5.09787, -5.71289,},
    {4.33651, 6.04508, -4.48182,},
    {3.72097, 3.87426, -4.10139,},
    {4.95205, 4.59787, -4.86224,},
    {2.5348, 4.73607, -5.8582,},
    {3.29565, 5.18328, -6.32843,},
    {3.91118, 4.73607, -3.63117,},
    {4.67203, 5.18328, -4.10139,},
    {2.87032, 3.87426, -5.47778,},
    {4.10139, 4.59787, -6.23862,},
    {4.36426, 3.78885, -4.86224,},
    {3.48586, 6.04508, -5.8582,},
    {4.40916, 5.9923, -5.47778,},
    {4.59937, -1.44721, -4.48182,},
    {7.06152, -2.34164, -5.47778,},
    {4.78959, -2.47984, -5.71289,},
    {7.08927, -2.25623, -4.48182,},
    {6.32843, -2.97984, -5.71289,},
    {5.71289, -2.25623, -3.63117,},
    {4.95205, -2.97984, -4.86224,},
    {5.28756, -0.947214, -5.8582,},
    {6.37333, -2.84164, -4.10139,},
    {5.9031, -3.28885, -4.86224,},
    {6.82641, -1.44721, -5.8582,},
    {4.57162, -1.53262, -5.47778,},
    {4.83449, -2.34164, -4.10139,},
    {5.948, -1.53262, -6.32843,},
    {5.64024, -2.47984, -6.23862,},
    {-0.615537, -6.1305, -6.23862,},
    {0.0449028, -7.43951, -4.48182,},
    {0.0449028, -4.82148, -4.48182,},
    {-0.878402, -6.93951, -5.71289,},
    {-0.878402, -5.32148, -5.71289,},
    {-0.733094, -6.93951, -4.10139,},
    {-0.733094, -5.32148, -4.10139,},
    {-1.30373, -6.6305, -4.86224,},
    {-1.30373, -5.6305, -4.86224,},
    {0.380423, -6.1305, -6.32843,},
    {-0.380423, -6.1305, -3.63117,},
    {0.733094, -6.93951, -5.8582,},
    {0.733094, -5.32148, -5.8582,},
    {-0.0449028, -7.43951, -5.47778,},
    {-0.0449028, -4.82148, -5.47778,},
    {-7.06152, -2.34164, -4.48182,},
    {-4.59937, -1.44721, -5.47778,},
    {-6.87131, -1.30902, -5.71289,},
    {-5.33247, -0.809017, -5.71289,},
    {-4.57162, -1.53262, -4.48182,},
    {-6.70885, -0.809017, -4.86224,},
    {-5.948, -1.53262, -3.63117,},
    {-6.37333, -2.84164, -5.8582,},
    {-5.75779, -0.5, -4.86224,},
    {-5.28756, -0.947214, -4.10139,},
    {-4.83449, -2.34164, -5.8582,},
    {-7.08927, -2.25623, -5.47778,},
    {-6.82641, -1.44721, -4.10139,},
    {-5.71289, -2.25623, -6.32843,},
    {-6.02066, -1.30902, -6.23862,},
    {-6.59129, 3.78885, -6.47374,},
    {-3.83853, 3.78885, -5.948,},
    {-5.64024, 2.47984, -6.47374,},
    {-5.64024, 5.09787, -6.47374,},
    {-4.10139, 2.97984, -6.47374,},
    {-4.10139, 4.59787, -6.47374,},
    {-5.47778, 2.97984, -7.32439,},
    {-5.47778, 4.59787, -7.32439,},
    {-4.52672, 3.28885, -7.32439,},
    {-4.52672, 4.28885, -7.32439,},
    {-6.32843, 2.97984, -5.948,},
    {-6.32843, 4.59787, -5.948,},
    {-6.06556, 3.78885, -7.32439,},
    {-4.78959, 2.47984, -5.948,},
    {-4.78959, 5.09787, -5.948,},
    {0.615537, 6.1305, -6.47374,},
    {3.3683, 6.1305, -5.948,},
    {1.56659, 4.82148, -6.47374,},
    {1.56659, 7.43951, -6.47374,},
    {3.10543, 5.32148, -6.47374,},
    {3.10543, 6.93951, -6.47374,},
    {1.72905, 5.32148, -7.32439,},
    {1.72905, 6.93951, -7.32439,},
    {2.68011, 5.6305, -7.32439,},
    {2.68011, 6.6305, -7.32439,},
    {0.878402, 5.32148, -5.948,},
    {0.878402, 6.93951, -5.948,},
    {1.14127, 6.1305, -7.32439,},
    {2.41724, 4.82148, -5.948,},
    {2.41724, 7.43951, -5.948,},
    {5.0696, -5.36524e-15, -6.47374,},
    {7.82237, -1.32154e-14, -5.948,},
    {6.02066, -1.30902, -6.47374,},
    {6.02066, 1.30902, -6.47374,},
    {7.5595, -0.809017, -6.47374,},
    {7.5595, 0.809017, -6.47374,},
    {6.18312, -0.809017, -7.32439,},
    {6.18312, 0.809017, -7.32439,},
    {7.13418, -0.5, -7.32439,},
    {7.13418, 0.5, -7.32439,},
    {5.33247, -0.809017, -5.948,},
    {5.33247, 0.809017, -5.948,},
    {5.59533, -7.92255e-15, -7.32439,},
    {6.87131, -1.30902, -5.948,},
    {6.87131, 1.30902, -5.948,},
    {0.615537, -6.1305, -6.47374,},
    {3.3683, -6.1305, -5.948,},
    {1.56659, -7.43951, -6.47374,},
    {1.56659, -4.82148, -6.47374,},
    {3.10543, -6.93951, -6.47374,},
    {3.10543, -5.32148, -6.47374,},
    {1.72905, -6.93951, -7.32439,},
    {1.72905, -5.32148, -7.32439,},
    {2.68011, -6.6305, -7.32439,},
    {2.68011, -5.6305, -7.32439,},
    {0.878402, -6.93951, -5.948,},
    {0.878402, -5.32148, -5.948,},
    {1.14127, -6.1305, -7.32439,},
    {2.41724, -7.43951, -5.948,},
    {2.41724, -4.82148, -5.948,},
    {-6.59129, -3.78885, -6.47374,},
    {-3.83853, -3.78885, -5.948,},
    {-5.64024, -5.09787, -6.47374,},
    {-5.64024, -2.47984, -6.47374,},
    {-4.10139, -4.59787, -6.47374,},
    {-4.10139, -2.97984, -6.47374,},
    {-5.47778, -4.59787, -7.32439,},
    {-5.47778, -2.97984, -7.32439,},
    {-4.52672, -4.28885, -7.32439,},
    {-4.52672, -3.28885, -7.32439,},
    {-6.32843, -4.59787, -5.948,},
    {-6.32843, -2.97984, -5.948,},
    {-6.06556, -3.78885, -7.32439,},
    {-4.78959, -5.09787, -5.948,},
    {-4.78959, -2.47984, -5.948,},
};

uint16_t indices[720] = {
        0,     1,     2,     3,     4,     5,     6,     7,     8,     9,
       10,    11,    12,    13,    14,    15,    16,    17,    18,    19,
        0,    20,    21,    22,    23,    24,    25,    26,     8,     9,
       27,    28,    29,    13,    14,    30,    31,    32,    33,    34,
       35,    36,    37,     3,    38,    39,    40,    41,    42,     9,
       43,    44,    45,    46,    14,    47,    48,    17,    49,    19,
       50,     1,    51,    52,    53,     5,    54,    55,    56,    57,
       58,    59,    12,    60,    61,    62,    63,    17,    64,    19,
       65,     1,    66,    67,     4,    68,    69,    70,    71,    72,
       73,    74,    12,    75,    76,    77,    16,    78,    18,    79,
       80,    81,     2,    82,    83,    84,    85,    86,     8,    87,
       88,    89,    90,    13,    91,    92,    16,    93,    18,    94,
       95,    96,    97,    98,    99,   100,   101,   102,   103,   104,
      105,   106,   107,   108,   109,   110,   111,   112,   113,   114,
      115,   116,   117,   118,   119,   120,   121,   122,   123,   124,
      125,   126,   127,   128,   129,   130,   131,   132,   133,   134,
      135,   136,   137,   138,   139,   140,   141,   142,   143,   144,
      145,   146,   147,   148,   149,   150,   151,   152,   153,   154,
      155,   156,   157,   158,   159,   160,   161,   162,   163,   164,
      165,   166,   167,   168,   169,   170,   171,   172,   173,   174,
      175,   176,   177,   178,   179,   180,   181,   182,   183,   184,
      185,   186,   187,   188,   189,   190,   191,   192,   193,   194,
      195,   196,   197,   198,   119,   199,   200,   201,   202,   203,
      125,   204,   205,   206,   207,   208,   209,   210,   211,   212,
      213,   214,   137,   215,   216,   217,   141,   218,   219,   220,
      221,   222,   223,   224,   225,   226,   227,   228,   229,   230,
      231,   232,   233,   234,   235,   236,   237,   238,   239,   240,
      241,   242,   243,   244,   245,   246,   247,   248,   249,   250,
      251,   252,   253,   178,   254,   255,   256,   182,   257,   258,
      259,   260,   261,   262,   263,   264,   265,   266,   267,   268,
      269,   270,   271,   272,   273,   100,   274,   275,   276,   277,
      278,   106,   279,   280,   281,   282,   283,   284,   285,   286,
      287,   116,   197,   288,   119,   120,   200,   289,   290,   291,
      125,   126,   292,   293,   294,   295,   296,   297,   211,   298,
      213,   299,   137,   300,   139,   301,   141,   302,   303,   304,
      145,   305,   306,   224,   307,   226,   308,   309,   153,   310,
      311,   312,   157,   234,   313,   314,   161,   238,   315,   316,
      317,   318,   319,   168,   245,   246,   320,   321,   322,   323,
      175,   324,   325,   178,   326,   255,   327,   182,   328,   329,
      330,   260,   331,   332,   189,   190,   333,   334,   335,   268,
      336,   270,   337,    98,   273,   100,   338,   102,   339,   340,
      278,   106,   341,   342,   343,   344,   345,   346,   347,   114,
      348,   349,   197,   350,   351,   352,   353,   354,   290,   355,
      356,   357,   358,   293,   359,   360,   296,   361,   211,   362,
      213,   363,   364,   365,   366,   367,   368,   369,   303,   304,
      370,   371,   372,   224,   307,   373,   374,   375,   376,   377,
      378,   379,   380,   234,   381,   382,   383,   384,   385,   316,
      386,   387,   388,   389,   245,   390,   391,   321,   392,   323,
      393,   324,   394,   395,   396,   255,   397,   398,   399,   400,
      401,   402,   331,   403,   404,   405,   406,   334,   407,   268,
      408,   270,   409,   410,   273,   411,   412,   413,   414,   415,
      416,   417,   341,   418,   419,   420,   345,   421,   347,   422,
      423,   116,   424,   425,   426,   120,   427,   428,   429,   430,
      431,   432,   292,   433,   434,   435,   436,   297,   437,   298,
      438,   299,   439,   440,   139,   441,   442,   443,   444,   445,
      446,   447,   306,   448,   449,   450,   308,   451,   153,   452,
      453,   454,   157,   455,   456,   457,   458,   459,   315,   460,
      461,   462,   463,   168,   464,   465,   320,   466,   322,   467,
      175,   468,   469,   470,   471,   472,   473,   474,   328,   329,
      475,   476,   477,   332,   189,   478,   479,   480,   481,   482,
      483,   484,   485,    98,   486,   487,   488,   489,   490,   340,
      491,   492,   493,   494,   343,   495,   496,   346,   497,   114,
      498,   499,   500,   501,   502,   503,   504,   505,   290,   291,
      506,   507,   292,   508,   509,   510,   296,   297,   511,   512,
      513,   514,   515,   516,   517,   518,   519,   520,   303,   304,
      521,   522,   306,   523,   524,   525,   308,   309,   526,   527,
      528,   529,   530,   531,   532,   533,   534,   535,   315,   316,
      536,   537,   319,   538,   539,   540,   320,   321,   541,   542,
      543,   544,   545,   546,   547,   548,   549,   550,   328,   329,
      551,   552,   331,   553,   554,   555,   333,   334,   556,   557,
      558,   559,   560,   561,   562,   563,   564,   565,   339,   340,
      566,   567,   341,   568,   569,   570,   345,   346,   571,   572,
};

shape_t shapes[36] = {
    {.index_start = indices + 0, .num_indices = 20,},
    {.index_start = indices + 20, .num_indices = 20,},
    {.index_start = indices + 35, .num_indices = 20,},
    {.index_start = indices + 50, .num_indices = 20,},
    {.index_start = indices + 65, .num_indices = 20,},
    {.index_start = indices + 80, .num_indices = 20,},
    {.index_start = indices + 95, .num_indices = 20,},
    {.index_start = indices + 115, .num_indices = 20,},
    {.index_start = indices + 135, .num_indices = 20,},
    {.index_start = indices + 155, .num_indices = 20,},
    {.index_start = indices + 175, .num_indices = 20,},
    {.index_start = indices + 195, .num_indices = 20,},
    {.index_start = indices + 213, .num_indices = 20,},
    {.index_start = indices + 231, .num_indices = 20,},
    {.index_start = indices + 251, .num_indices = 20,},
    {.index_start = indices + 269, .num_indices = 20,},
    {.index_start = indices + 287, .num_indices = 20,},
    {.index_start = indices + 299, .num_indices = 20,},
    {.index_start = indices + 311, .num_indices = 20,},
    {.index_start = indices + 324, .num_indices = 20,},
    {.index_start = indices + 336, .num_indices = 20,},
    {.index_start = indices + 348, .num_indices = 20,},
    {.index_start = indices + 363, .num_indices = 20,},
    {.index_start = indices + 378, .num_indices = 20,},
    {.index_start = indices + 393, .num_indices = 20,},
    {.index_start = indices + 408, .num_indices = 20,},
    {.index_start = indices + 423, .num_indices = 20,},
    {.index_start = indices + 438, .num_indices = 20,},
    {.index_start = indices + 453, .num_indices = 20,},
    {.index_start = indices + 468, .num_indices = 20,},
    {.index_start = indices + 483, .num_indices = 20,},
    {.index_start = indices + 498, .num_indices = 20,},
    {.index_start = indices + 513, .num_indices = 20,},
    {.index_start = indices + 528, .num_indices = 20,},
    {.index_start = indices + 543, .num_indices = 20,},
    {.index_start = indices + 558, .num_indices = 20,},
};

group_t groups[8] = {
    {.shape_start = shapes + 0, .num_shapes = 1},
    {.shape_start = shapes + 1, .num_shapes = 5},
    {.shape_start = shapes + 6, .num_shapes = 5},
    {.shape_start = shapes + 11, .num_shapes = 5},
    {.shape_start = shapes + 16, .num_shapes = 5},
    {.shape_start = shapes + 21, .num_shapes = 5},
    {.shape_start = shapes + 26, .num_shapes = 5},
    {.shape_start = shapes + 31, .num_shapes = 5},
};


void gles2_harness_update(float time)
{
    GLfloat viewMatrix[16];
    GLfloat viewProjectionMatrix[16];
    GLfloat modelMatrix[16];
    
    GLfloat pixel_spacing = 0.1f;
    
    int64_t frame_nsec = (int64_t)round(time * 1.0e9);
    
    
    /////artifactuary_process(gles2_harness_total_nsec, frame_nsec);
    
    gles2_harness_total_nsec += frame_nsec;
    
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    
    
    glusLookAtf(viewMatrix,
        0.0f, 10.0f, 0.0f,
        0.0f, 0.0f, 0.0f,
        0.0f, 0.0f, 1.0f);
    glusPerspectivef(viewProjectionMatrix, 45.0f, g_aspectRatio, 0.1f, 1000.0f);
    glusMatrix4x4Multiplyf(viewProjectionMatrix, viewProjectionMatrix, viewMatrix);
    
    
    glUseProgram(g_program);
    
    
    glUniformMatrix4fv(g_viewProjectionMatrixLocation, 1, GL_FALSE, viewProjectionMatrix);
    
    glBindBuffer(GL_ARRAY_BUFFER, g_verticesVBO);
    glVertexAttribPointer(g_vertexLocation, 4, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(g_vertexLocation);
    
    glBindBuffer(GL_ARRAY_BUFFER, 0);
    
    for(size_t i = 0; i < sizeof groups / sizeof *groups; ++i) {
        for(size_t j = 0; j < groups[i].num_shapes; ++j) {
            shape_t * shape = &groups[i].shape_start[j];
            for(size_t k = 0; k < shape->num_indices; ++k) {
                vertex_t * vertex = &vertices[shape->index_start[k]];
                
                /////////
                glusMatrix4x4Identityf(modelMatrix);
                glusMatrix4x4Translatef(modelMatrix, vertex->x, vertex->y, vertex->z);
                glusMatrix4x4Scalef(modelMatrix, pixel_spacing * 0.5f, pixel_spacing * 0.5f, 1.0f);
                glUniformMatrix4fv(g_modelMatrixLocation, 1, GL_FALSE, modelMatrix);
    
                glUniform4f(g_colorLocation,
                    255.0f * (1.0f / 255.0f),
                    127.0f * (1.0f / 255.0f),
                    63.0f * (1.0f / 255.0f),
                    0.0f);
    
                glDrawArrays(GL_TRIANGLE_STRIP, 0, 4);
                ////////
            }
        }
    }    
    
    glDisableVertexAttribArray(g_vertexLocation);
    
    glUseProgram(0);
}

void gles2_harness_terminate(void)
{
    glBindBuffer(GL_ARRAY_BUFFER, 0);
    
    glDeleteBuffers(1, &g_verticesVBO);
    
    glUseProgram(0);
    
    glDeleteProgram(g_program);
    glDeleteShader(g_vertShader);
    glDeleteShader(g_fragShader);
}
